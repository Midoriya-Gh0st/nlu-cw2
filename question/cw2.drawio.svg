<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1571px" height="802px" viewBox="-0.5 -0.5 1571 802" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2022-03-17T22:58:18.346Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36&quot; etag=&quot;8EXRXQ8_HdqtAlDqC3d-&quot; version=&quot;16.6.5&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;NqwoHdrc9J_9epwf5Tod&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-24-349-152-26-0"><rect x="24" y="349" width="152" height="26"/></clipPath><clipPath id="mx-clip-24-375-152-26-0"><rect x="24" y="375" width="152" height="26"/></clipPath><clipPath id="mx-clip-24-401-152-26-0"><rect x="24" y="401" width="152" height="26"/></clipPath><clipPath id="mx-clip-254-349-122-26-0"><rect x="254" y="349" width="122" height="26"/></clipPath><clipPath id="mx-clip-254-375-122-26-0"><rect x="254" y="375" width="122" height="26"/></clipPath><clipPath id="mx-clip-254-401-122-26-0"><rect x="254" y="401" width="122" height="26"/></clipPath></defs><g><rect x="240" y="336" width="150" height="94" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><path d="M 950 640 L 950 743.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 950 748.88 L 946.5 741.88 L 950 743.63 L 953.5 741.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="760" y="340" width="380" height="300" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="760" y="310" width="200" height="30" rx="4.5" ry="4.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 198px; height: 1px; padding-top: 325px; margin-left: 761px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">for j in range(tgt_time_steps):</div></div></div></foreignObject><text x="860" y="329" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px" text-anchor="middle">for j in range(tgt_time_steps):</text></switch></g><rect x="750" y="20" width="390" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 388px; height: 1px; padding-top: 50px; margin-left: 751px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Decoder::<br />forward(self, tgt_inputs, encoder_out, incremental_state=None):</div></div></div></foreignObject><text x="945" y="54" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px" text-anchor="middle">Decoder::...</text></switch></g><rect x="570" y="120" width="160" height="110" rx="16.5" ry="16.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 175px; margin-left: 572px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">根据 encoder_out获取:<br />---------------------------------<br />- src_out<br />- src_hidden_state<br />- src_cell_state<br />- src_mask<br />- src_time_steps</div></div></div></foreignObject><text x="572" y="179" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px">根据 encoder_out获取:...</text></switch></g><rect x="770" y="135" width="160" height="80" rx="12" ry="12" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 175px; margin-left: 772px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">根据 tgt_inputs获取:<br />----------------------------<br />- batch_size<br />- tgt_time_steps<br />- tgt_embeddings</div></div></div></foreignObject><text x="772" y="179" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px">根据 tgt_inputs获取:...</text></switch></g><rect x="970" y="125" width="160" height="90" rx="13.5" ry="13.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 170px; margin-left: 972px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">初始化:<br />[all_zero] 或者从catch获取<br />-----------------------------------<br />- tgt_hidden_states;<br />- tgt_cell_states;<br />- input_feed</div></div></div></foreignObject><text x="972" y="174" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px">初始化:...</text></switch></g><rect x="1170" y="145" width="160" height="60" rx="9" ry="9" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 175px; margin-left: 1172px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div><span>初始化:</span></div><div><span>-----------------------------------</span></div><div><span>- attn_weights: [all_zero];</span></div><div><span>- rnn_outputs = []</span></div></div></div></div></foreignObject><text x="1172" y="179" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px">初始化:...</text></switch></g><path d="M 980 385 L 980 418.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 980 423.88 L 976.5 416.88 L 980 418.63 L 983.5 416.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="840" y="355" width="280" height="30" rx="4.5" ry="4.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 370px; margin-left: 841px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">lstm_input ~ input_feed</div></div></div></foreignObject><text x="980" y="374" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px" text-anchor="middle">lstm_input ~ input_feed</text></switch></g><path d="M 980 455 L 980 498.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 980 503.88 L 976.5 496.88 L 980 498.63 L 983.5 496.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="840" y="425" width="280" height="30" rx="4.5" ry="4.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 440px; margin-left: 841px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">tgt_hidden_state ~ rnn_layer(lstm_input)</div></div></div></foreignObject><text x="980" y="444" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px" text-anchor="middle">tgt_hidden_state ~ rnn_layer(lstm_input)</text></switch></g><rect x="1150" y="515" width="280" height="30" rx="4.5" ry="4.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 530px; margin-left: 1151px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">lstm_input ~ F.dropout(tgt_hidden_state)</div></div></div></foreignObject><text x="1290" y="534" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px" text-anchor="middle">lstm_input ~ F.dropout(tgt_hidden_state)</text></switch></g><path d="M 980 555 L 980 588.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 980 593.88 L 976.5 586.88 L 980 588.63 L 983.5 586.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="840" y="505" width="280" height="50" rx="7.5" ry="7.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 530px; margin-left: 841px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">input_feed = <font color="#cc0066"><b>Attention</b></font>(<b><i>tgt_hidden_satte</i></b>)<br /><div style="text-align: left"><span>                = attn_out</span></div></div></div></div></foreignObject><text x="980" y="534" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px" text-anchor="middle">input_feed = Attention(tgt_hidden_satte)...</text></switch></g><rect x="840" y="595" width="280" height="30" rx="4.5" ry="4.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 610px; margin-left: 841px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">rnn_outputs.append(input_feed)</div></div></div></foreignObject><text x="980" y="614" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px" text-anchor="middle">rnn_outputs.append(input_feed)</text></switch></g><rect x="740" y="750" width="280" height="30" rx="4.5" ry="4.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 765px; margin-left: 741px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">decoder_out ~ rnn_outputs</div></div></div></foreignObject><text x="880" y="769" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px" text-anchor="middle">decoder_out ~ rnn_outputs</text></switch></g><path d="M 680 530 L 833.63 530" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 838.88 530 L 831.88 533.5 L 833.63 530 L 831.88 526.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="400" y="455" width="280" height="150" rx="22.5" ry="22.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 530px; margin-left: 401px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b><font color="#cc0066">Attention</font></b>:<br />forward(tgt_input, encoder_out, src_mask)<br /><br />return :: attn_out = <br />tanh(Wc · Context_with_hidden)</div></div></div></foreignObject><text x="540" y="534" fill="rgb(0, 0, 0)" font-family="Tahoma" font-size="12px" text-anchor="middle">Attention:...</text></switch></g><rect x="1200" y="305" width="350" height="80" rx="12" ry="12" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 348px; height: 1px; padding-top: 345px; margin-left: 1201px;"><div data-drawio-colors="color: #CC0066; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(204, 0, 102); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">input_feed, <font color="#000000">step_attn_weights =</font> self.attention(<b><i><font color="#000000">tgt_hidden_states</font></i></b>[-1], <font color="#000000">src_out, src_mask</font>)</div></div></div></foreignObject><text x="1375" y="349" fill="#CC0066" font-family="Tahoma" font-size="12px" text-anchor="middle">input_feed, step_attn_weights = self.attention(tgt_hidden_...</text></switch></g><rect x="20" y="30" width="200" height="260" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 198px; height: 1px; padding-top: 37px; margin-left: 22px;"><div data-drawio-colors="color: #000000; border-color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Tahoma; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; border: 1px solid rgb(0, 0, 0); white-space: normal; overflow-wrap: normal;"><div style="direction: ltr ; font-size: 13px"><div style="direction: ltr ; margin-top: 0in ; margin-left: 0in ; width: 2.0909in"><div style="direction: ltr ; margin-top: 0in ; margin-left: 0in ; width: 2.0909in"><p style="margin: 0in" lang="en-US">Encoder</p><br /><p style="margin: 0in" lang="en-US"><span>     </span>- decoder-1</p><p style="margin: 0in" lang="en-US"><span>        </span>-- <font color="#ff0080"><b>attn-forward</b></font> * 1</p><p style="margin: 0in" lang="en-US"><span>        </span>-- attn-forward * 2</p><p style="margin: 0in" lang="en-US"><span>            </span>…</p><p style="margin: 0in" lang="en-US"><span>        </span>-- attn-forward * 25</p><p style="margin: 0in" lang="en-US"><span>     </span>- decoder-2</p><p style="margin: 0in" lang="en-US"><span>        </span>-- attn-forward * 1</p><p style="margin: 0in" lang="en-US"><span>        </span>-- attn-forward * 2</p><p style="margin: 0in" lang="en-US"><span>            </span>…</p><p style="margin: 0in" lang="en-US"><span>        </span>-- attn-forward * 25</p><p style="margin: 0in" lang="en-US"><span>     </span>…...</p><p style="margin: 0in" lang="en-US"><span>      </span>- decoder-25<span>       </span></p></div></div><br /></div></div></div></div></foreignObject><text x="22" y="49" fill="#000000" font-family="Tahoma" font-size="12px">Encoder...</text></switch></g><path d="M 20 336 L 20 310 L 180 310 L 180 336" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 20 336 L 20 422 L 180 422 L 180 336" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 20 336 L 180 336" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Tahoma" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="13px"><text x="99.5" y="328.5">encoder-output</text></g><path d="M 20 340 L 180 340" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Tahoma" pointer-events="none" clip-path="url(#mx-clip-24-349-152-26-0)" font-size="13px"><text x="25.5" y="362.5">+ src_embedding</text></g><rect x="20" y="370" width="160" height="26" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Tahoma" pointer-events="none" clip-path="url(#mx-clip-24-375-152-26-0)" font-size="13px"><text x="25.5" y="388.5">+ src_out</text></g><g fill="#000000" font-family="Tahoma" pointer-events="none" clip-path="url(#mx-clip-24-401-152-26-0)" font-size="13px"><text x="25.5" y="414.5">+ src_mask</text></g><rect x="250" y="344" width="130" height="26" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Tahoma" pointer-events="none" clip-path="url(#mx-clip-254-349-122-26-0)" font-size="13px"><text x="255.5" y="362.5">- lstm_out</text></g><rect x="250" y="370" width="130" height="26" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Tahoma" pointer-events="none" clip-path="url(#mx-clip-254-375-122-26-0)" font-size="13px"><text x="255.5" y="388.5">- final_hidden_state</text></g><rect x="250" y="396" width="130" height="26" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Tahoma" pointer-events="none" clip-path="url(#mx-clip-254-401-122-26-0)" font-size="13px"><text x="255.5" y="414.5">- final_cell_state</text></g><path d="M 180 383 L 233.63 383" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 238.88 383 L 231.88 386.5 L 233.63 383 L 231.88 379.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>